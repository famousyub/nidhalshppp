{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/g702306/Desktop/testy000/appliomm/E--commerce/pfa/front/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/g702306/Desktop/testy000/appliomm/E--commerce/pfa/front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport AuthenticationService from \"@/services/AuthenticationService.js\";\nimport UserService from \"@/services/UserService.js\";\nexport default {\n  name: \"ReqPassToken\",\n  components: {},\n  data: function data() {\n    return {\n      emailResetPassword: null,\n      tokenAlert: null,\n      mailSent: false,\n      tokenAlertMessage: null\n    };\n  },\n  computed: {},\n  methods: {\n    requestPasswordToken: function requestPasswordToken() {\n      var _this = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var user;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _this.mailSent = false;\n              _context.next = 4;\n              return UserService.getUserByEmail(_this.emailResetPassword);\n            case 4:\n              user = _context.sent.data;\n              _context.next = 11;\n              break;\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              _this.tokenAlert = true;\n              _this.tokenAlertMessage = _context.t0.response.data.error;\n            case 11:\n              if (!user) {\n                _context.next = 24;\n                break;\n              }\n              _context.prev = 12;\n              _context.next = 15;\n              return AuthenticationService.requestPasswordToken({\n                email: _this.emailResetPassword\n              });\n            case 15:\n              _this.tokenAlert = false;\n              _this.mailSent = true;\n              _this.emailResetPassword = \"\";\n              _context.next = 24;\n              break;\n            case 20:\n              _context.prev = 20;\n              _context.t1 = _context[\"catch\"](12);\n              _this.tokenAlert = true;\n              _this.tokenAlertMessage = _context.t1.response.data.error;\n            case 24:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[0, 7], [12, 20]]);\n      }))();\n    }\n  }\n};","map":{"version":3,"names":["AuthenticationService","UserService","name","components","data","emailResetPassword","tokenAlert","mailSent","tokenAlertMessage","computed","methods","requestPasswordToken","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","user","wrap","_callee$","_context","prev","next","getUserByEmail","sent","t0","response","error","email","t1","stop"],"sources":["src/components/User/ReqPassToken.vue"],"sourcesContent":["<template>\r\n    <div>\r\n      <div class=\"p-2 mt-2\" style=\"background-color: #f4f6f8\">\r\n        <b-form @submit.stop.prevent=\"requestPasswordToken\">\r\n          <b-form-group\r\n            class=\"mb-2 font-weight-bold\"\r\n            label=\"Enter your email address\"\r\n            label-for=\"input-email-for-token\"\r\n          >\r\n            <b-form-input\r\n              v-model=\"emailResetPassword\"\r\n              ref=\"emailField2\"\r\n              id=\"input-email-for-token\"\r\n              @keyup=\"mailSent = false\"\r\n              type=\"email\"\r\n              required\r\n            />\r\n          </b-form-group>\r\n          <small>Nous vous enverrons un lien pour réinitialiser votre mot de passe.</small><br />\r\n          <b-alert variant=\"primary\" class=\"my-2 p-1 pl-2\" :show=\"tokenAlert\">\r\n            {{ tokenAlertMessage }}\r\n          </b-alert>\r\n          <b-button class=\"mt-2\" variant=\"outline-dark\" type=\"submit\">\r\n            Submit\r\n          </b-button>\r\n          <b-card class=\"mt-3\" v-if=\"mailSent\">\r\n            <div><strong>Requête acceptée</strong></div>\r\n            <hr class=\"my-1\" />\r\n            <div>\r\n              Vérifiez votre e-mail pour un lien pour réinitialiser votre mot de passe. Si ce n'est pas le cas\r\n              apparaissent dans quelques minutes, vérifiez votre dossier spam.\r\n            </div>\r\n          </b-card>\r\n        </b-form>\r\n      </div>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import AuthenticationService from \"@/services/AuthenticationService.js\";\r\n  import UserService from \"@/services/UserService.js\";\r\n  export default {\r\n    name: \"ReqPassToken\",\r\n    components: {},\r\n    data() {\r\n      return {\r\n        emailResetPassword: null,\r\n        tokenAlert: null,\r\n        mailSent: false,\r\n        tokenAlertMessage: null,\r\n      };\r\n    },\r\n    computed: {},\r\n    methods: {\r\n      async requestPasswordToken() {\r\n        var user;\r\n        try {\r\n          this.mailSent = false;\r\n          user = (await UserService.getUserByEmail(this.emailResetPassword)).data;\r\n        } catch (error) {\r\n          this.tokenAlert = true;\r\n          this.tokenAlertMessage = error.response.data.error;\r\n        }\r\n        if (user) {\r\n          try {\r\n            await AuthenticationService.requestPasswordToken({\r\n              email: this.emailResetPassword,\r\n            });\r\n            this.tokenAlert = false;\r\n            this.mailSent = true;\r\n            this.emailResetPassword = \"\";\r\n          } catch (error) {\r\n            this.tokenAlert = true;\r\n            this.tokenAlertMessage = error.response.data.error;\r\n          }\r\n        }\r\n      },\r\n    },\r\n  };\r\n  </script>\r\n  \r\n  <style lang=\"scss\" scoped></style>\r\n  "],"mappings":";;AAuCA,OAAAA,qBAAA;AACA,OAAAC,WAAA;AACA;EACAC,IAAA;EACAC,UAAA;EACAC,IAAA,WAAAA,KAAA;IACA;MACAC,kBAAA;MACAC,UAAA;MACAC,QAAA;MACAC,iBAAA;IACA;EACA;EACAC,QAAA;EACAC,OAAA;IACAC,oBAAA,WAAAA,qBAAA;MAAA,IAAAC,KAAA;MAAA,OAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,UAAAC,QAAA;QAAA,IAAAC,IAAA;QAAA,OAAAH,mBAAA,GAAAI,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAGAT,KAAA,CAAAL,QAAA;cAAAa,QAAA,CAAAE,IAAA;cAAA,OACArB,WAAA,CAAAsB,cAAA,CAAAX,KAAA,CAAAP,kBAAA;YAAA;cAAAY,IAAA,GAAAG,QAAA,CAAAI,IAAA,CAAApB,IAAA;cAAAgB,QAAA,CAAAE,IAAA;cAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAK,EAAA,GAAAL,QAAA;cAEAR,KAAA,CAAAN,UAAA;cACAM,KAAA,CAAAJ,iBAAA,GAAAY,QAAA,CAAAK,EAAA,CAAAC,QAAA,CAAAtB,IAAA,CAAAuB,KAAA;YAAA;cAAA,KAEAV,IAAA;gBAAAG,QAAA,CAAAE,IAAA;gBAAA;cAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAE,IAAA;cAAA,OAEAtB,qBAAA,CAAAW,oBAAA;gBACAiB,KAAA,EAAAhB,KAAA,CAAAP;cACA;YAAA;cACAO,KAAA,CAAAN,UAAA;cACAM,KAAA,CAAAL,QAAA;cACAK,KAAA,CAAAP,kBAAA;cAAAe,QAAA,CAAAE,IAAA;cAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAS,EAAA,GAAAT,QAAA;cAEAR,KAAA,CAAAN,UAAA;cACAM,KAAA,CAAAJ,iBAAA,GAAAY,QAAA,CAAAS,EAAA,CAAAH,QAAA,CAAAtB,IAAA,CAAAuB,KAAA;YAAA;YAAA;cAAA,OAAAP,QAAA,CAAAU,IAAA;UAAA;QAAA,GAAAd,OAAA;MAAA;IAGA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}